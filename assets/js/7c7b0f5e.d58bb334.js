"use strict";(self.webpackChunkcclog=self.webpackChunkcclog||[]).push([[262],{9216:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>t,contentTitle:()=>o,default:()=>x,frontMatter:()=>d,metadata:()=>c,toc:()=>i});const c=JSON.parse('{"id":"docker/cmd-vs-entrypoint","title":"CMD vs ENTRYPOINT","description":"\u524d\u8a00","source":"@site/docs/docker/cmd-vs-entrypoint.md","sourceDirName":"docker","slug":"/docker/cmd-vs-entrypoint","permalink":"/cclog/docs/docker/cmd-vs-entrypoint","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"CMD vs ENTRYPOINT","last_update":{"date":20241110},"pagination_next":null},"sidebar":"tutorialSidebar","previous":{"title":"Docker","permalink":"/cclog/docs/category/docker"}}');var r=s(4848),l=s(8453);const d={title:"CMD vs ENTRYPOINT",last_update:{date:20241110},pagination_next:null},o=void 0,t={},i=[{value:"\u524d\u8a00",id:"\u524d\u8a00",level:2},{value:"CMD",id:"cmd",level:2},{value:"\u8a9e\u6cd5",id:"\u8a9e\u6cd5",level:3},{value:"ENTRYPOINT",id:"entrypoint",level:2}];function h(e){const n={a:"a",br:"br",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"\u524d\u8a00",children:"\u524d\u8a00"}),"\n",(0,r.jsxs)(n.p,{children:["\u5728 Dockerfile \u4e2d\uff0c\u6709\u4e00\u4e9b\u6307\u4ee4\u975e\u5e38\u76f8\u4f3c\uff0c\u50cf\u662f ",(0,r.jsx)(n.code,{children:"CMD"})," \u8ddf ",(0,r.jsx)(n.code,{children:"ENTRYPOINT"})," \u7b49\u7b49"]}),"\n",(0,r.jsxs)(n.p,{children:["\u9019\u7bc7\u6703\u63a2\u8a0e\u5728 Dockerfile \u4e2d\u7684 ",(0,r.jsx)(n.code,{children:"CMD"})," \u8ddf ",(0,r.jsx)(n.code,{children:"ENTRYPOINT"})," \u5230\u5e95\u6709\u4ec0\u9ebc\u4e0d\u4e00\u6a23"]}),"\n",(0,r.jsx)(n.h2,{id:"cmd",children:"CMD"}),"\n",(0,r.jsxs)(n.p,{children:["\u525b\u5165\u9580\u7684\u6642\u5019\u53ef\u80fd\u5c31\u6703\u8a8d\u70ba ",(0,r.jsx)(n.code,{children:"CMD"})," \u5c31\u662f\u5bb9\u5668\u555f\u52d5\u6642\u7684\u547d\u4ee4",(0,r.jsx)(n.br,{}),"\n","\u4e0b\u9762\u4ecb\u7d39 ",(0,r.jsx)(n.code,{children:"ENTRYPOINT"})," \u6642\u6703\u518d\u8aaa\u660e\u4ed6\u8207 ",(0,r.jsx)(n.code,{children:"CMD"})," \u7684\u95dc\u4fc2"]}),"\n",(0,r.jsxs)(n.p,{children:["\u4e00\u500b stage \u53ea\u6703\u6709\u4e00\u500b ",(0,r.jsx)(n.code,{children:"CMD"}),(0,r.jsx)(n.br,{}),"\n","\u5beb\u5f88\u591a\u500b ",(0,r.jsx)(n.code,{children:"CMD"})," \u53ea\u6709\u6700\u5f8c\u4e00\u500b\u6703\u751f\u6548",(0,r.jsx)(n.br,{}),"\n","\u5982\u679c\u4e0d\u77e5\u9053 stage \u662f\u4ec0\u9ebc\u7684\u8a71\u5c31\u662f\u6bcf\u500b ",(0,r.jsx)(n.code,{children:"FROM"})," \u958b\u59cb\u90fd\u662f\u4e00\u500b stage"]}),"\n",(0,r.jsx)(n.h3,{id:"\u8a9e\u6cd5",children:"\u8a9e\u6cd5"}),"\n",(0,r.jsxs)(n.p,{children:["\u901a\u5e38(\u5f8c\u9762\u6703\u8b1b\u5230\u5176\u4ed6\u60c5\u6cc1) \u7b2c\u4e00\u500b\u90fd\u6703\u662f\u4e00\u500b executable",(0,r.jsx)(n.br,{}),"\n","\u5f8c\u9762\u63a5\u8457\u4ed6\u7684\u53c3\u6578"]}),"\n",(0,r.jsxs)(n.p,{children:["\u53ef\u4ee5\u628a\u7260\u5011\u90fd\u653e\u5728 list \u88e1\u9762",(0,r.jsx)(n.br,{}),"\n","\u6216\u662f\u76f4\u63a5\u7528\u7a7a\u683c\u9694\u958b",(0,r.jsx)(n.br,{}),"\n","\u5b98\u65b9\u5efa\u8b70\u662f\u653e\u5728 list \u88e1\u9762",(0,r.jsx)(n.br,{}),"\n","\u6ce8\u610f\u9019\u908a\u4e0d\u80fd\u4f7f\u7528\u55ae\u5f15\u865f ' \u5305\u8d77\u4f86\uff0c\u539f\u56e0\u4e0b\u9762\u6703\u8aaa\u660e"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-Docker",children:'FROM alpine\nCMD ["echo", "hello"]\n# or CMD echo hello\n'})}),"\n",(0,r.jsxs)(n.p,{children:["\u4f46\u662f\u82e5\u5728\u555f\u52d5 container \u6642\u984d\u5916\u63d0\u4f9b\u4e86\u4e00\u500b executable \u5c31\u6703\u76f4\u63a5\u8986\u84cb\u6389 ",(0,r.jsx)(n.code,{children:"CMD"})," \u7684\u5167\u5bb9"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"$ docker build -t test .\n$ docker run test ls # \u555f\u52d5\u5bb9\u5668\u5f8c\u57f7\u884c\u7684\u547d\u4ee4\u8b8a\u6210ls\n"})}),"\n",(0,r.jsx)(n.h2,{id:"entrypoint",children:"ENTRYPOINT"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"ENTRYPOINT"})," \u8a9e\u6cd5\u8207 ",(0,r.jsx)(n.code,{children:"CMD"})," \u4e00\u6a21\u4e00\u6a23"]}),"\n",(0,r.jsxs)(n.p,{children:["\u5bb9\u5668\u555f\u52d5\u7684\u6642\u5019\u5176\u5be6\u771f\u6b63\u7684\u547d\u4ee4\u662f ",(0,r.jsx)(n.code,{children:"ENTRYPOINT 'CMD'"}),(0,r.jsx)(n.br,{}),"\n","\u9810\u8a2d\u7684 entrypoint \u662f ",(0,r.jsx)(n.code,{children:"sh -c"}),(0,r.jsx)(n.br,{}),"\n","\u9019\u4e5f\u662f\u70ba\u4ec0\u9ebc\u4f60\u4e0d\u80fd\u5728 CMD \u4e2d\u4f7f\u7528 '\uff0c\u56e0\u70ba\u4ed6\u5df2\u7d93\u5728 '' \u88e1\u9762\u4e86",(0,r.jsx)(n.br,{}),"\n","\u90a3\u6211\u5011\u5df2\u7d93\u6709 ",(0,r.jsx)(n.code,{children:"CMD"})," \u4e86\u70ba\u4ec0\u9ebc\u9084\u9700\u8981 ",(0,r.jsx)(n.code,{children:"ENTRYPOINT"})," \u5462\uff1f",(0,r.jsx)(n.br,{}),"\n","cmd \u5176\u5be6\u6bd4\u8f03\u50cf\u63d0\u4f9b\u7d66 entrypoint \u7684\u53c3\u6578",(0,r.jsx)(n.br,{}),"\n","\u800c\u9019\u500b\u53c3\u6578\u4e5f\u53ef\u4ee5\u5728\u5bb9\u5668\u555f\u52d5\u6642\u6539\u7531\u7528\u6236\u63d0\u4f9b",(0,r.jsx)(n.br,{}),"\n","\u6211\u5011\u53ef\u4ee5\u770b\u4e0b\u9762\u7684\u4f8b\u5b50",(0,r.jsx)(n.br,{}),"\n","\u7167\u7406\u4f86\u8aaa\u5bb9\u5668\u53ea\u6703\u8f38\u51fa hello",(0,r.jsx)(n.br,{}),"\n","\u4f46\u662f\u6211\u5728\u6700\u5f8c\u63d0\u4f9b\u4e86\u4e00\u500b cmd\uff0c\u5167\u5bb9\u662f ls",(0,r.jsx)(n.br,{}),"\n","\u56e0\u6b64\u6700\u5f8c\u7684\u8f38\u51fa\u662f hello ls"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-docker",children:'FROM alpine \nENTRYPOINT ["echo", "hello"]\n'})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"$ docker build -t test .\n$ docker run test ls\nhello ls\n$ \n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u6240\u4ee5 ",(0,r.jsx)(n.code,{children:"ENTRYPOINT"})," \u9069\u5408\u653e\u7f6e\u4e00\u4e9b\u5fc5\u9808\u8981\u57f7\u884c\u7684script",(0,r.jsx)(n.br,{}),"\n","\u8209\u4f8b\u4f86\u8aaa PostgreSQL \u7684 ",(0,r.jsx)(n.a,{href:"https://github.com/docker-library/postgres/blob/ee530cc079f232f9b1045db43d8c501ee2057d6d/16/bookworm/Dockerfile#L186",children:"Dockerfile"})," \u8a2d\u5b9a\u4e86 ",(0,r.jsx)(n.code,{children:'ENTRYPOINT ["docker-entrypoint.sh"]'}),(0,r.jsx)(n.br,{}),"\n","\u5728\u90a3\u500b shell script \u4e2d\u6703\u751f\u6210 postgres \u5fc5\u9808\u7684\u6587\u4ef6\u4ee5\u53ca\u8a2d\u5b9a\u4e00\u4e9b\u6b0a\u9650",(0,r.jsx)(n.br,{}),"\n","\u82e5\u662f\u9019\u500b shell script \u6c92\u6709\u57f7\u884c\u53ef\u80fd\u6703\u5c0e\u81f4\u4e00\u4e9b\u554f\u984c",(0,r.jsx)(n.br,{}),"\n","\u56e0\u6b64\u4f7f\u7528 ENTRYPOINT \u8b93\u4ed6\u7121\u6cd5\u88ab\u7528\u6236\u63d0\u4f9b\u7684 ",(0,r.jsx)(n.code,{children:"CMD"})," \u8986\u84cb",(0,r.jsx)(n.br,{}),"\n","\u7576\u7136\u7528\u6236\u771f\u7684\u60f3\u8981\u7684\u8a71\u4e5f\u80fd\u900f\u904e ",(0,r.jsx)(n.code,{children:"--entrypoint"})," \u4f86\u8986\u5beb"]})]})}function x(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>d,x:()=>o});var c=s(6540);const r={},l=c.createContext(r);function d(e){const n=c.useContext(l);return c.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),c.createElement(l.Provider,{value:n},e.children)}}}]);